<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Castor Strategic Matrix v5.0</title>
    <!-- ÂºïÂÖ• Tailwind CSS Á°Æ‰øùÊ†∑ÂºèÊï¥ÈΩê -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ÂºïÂÖ• Chart.js Âà∂‰ΩúÊï∞ÊçÆÂåñÂõæË°® -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- ÂºïÂÖ• FontAwesome ÂõæÊ†á -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'git-bg': '#0d1117',
                        'git-border': '#30363d',
                        'git-blue': '#58a6ff',
                        'git-green': '#3fb950',
                        'git-red': '#f85149'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&family=Inter:wght@400;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0d1117; color: #c9d1d9; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glass { background: rgba(22, 27, 34, 0.8); backdrop-filter: blur(12px); border: 1px solid #30363d; }
        .heatmap-cell { width: 12px; height: 12px; border-radius: 2px; }
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; color: black !important; }
            .glass { background: white !important; border: 1px solid #ccc !important; box-shadow: none !important; color: black !important; }
        }
        /* ÈöêËóèÊªöÂä®Êù°‰ΩÜ‰øùÁïôÂäüËÉΩ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen antialiased selection:bg-git-green selection:text-white">

    <div class="max-w-6xl mx-auto flex flex-col gap-8">
        
        <!-- Header: GitHub Pro Style -->
        <header class="flex justify-between items-center border-b border-git-border pb-6 no-print">
            <div class="flex items-center gap-4">
                <div class="p-3 bg-slate-900 border border-git-border rounded-xl text-git-blue shadow-inner">
                    <i class="fa-brands fa-github text-3xl"></i>
                </div>
                <div>
                    <div class="flex items-center gap-2">
                        <h1 class="text-xl font-bold text-white tracking-tight">castor-life-v5.0-stable</h1>
                        <span class="text-[10px] font-bold border border-git-green px-2 py-0.5 rounded-full text-git-green bg-git-green/10 uppercase">Production</span>
                    </div>
                    <p class="text-xs text-slate-500 font-mono mt-1 flex items-center gap-2 uppercase tracking-tighter">
                        <i class="fa-solid fa-code-branch text-[10px]"></i> origin / holographic-unicode-safe
                    </p>
                </div>
            </div>
            <div class="flex gap-3">
                <button onclick="shareWhatsApp()" class="flex items-center gap-2 px-4 py-2 bg-[#21262d] border border-git-border rounded-lg text-sm font-semibold hover:border-slate-400 transition-all">
                    <i class="fa-brands fa-whatsapp text-git-green text-lg"></i> <span class="hidden sm:inline">WhatsApp</span>
                </button>
                <button onclick="window.print()" class="flex items-center gap-2 px-4 py-2 bg-git-green border border-[#2ea44f] text-white rounded-lg text-sm font-semibold hover:bg-[#2ea44f] transition-all shadow-md">
                    <i class="fa-solid fa-print"></i> <span class="hidden sm:inline">PDF Report</span>
                </button>
            </div>
        </header>

        <!-- 1. ÊéßÂà∂Âè∞ÈÖçÁΩÆÈù¢Êùø -->
        <section class="grid grid-cols-1 lg:grid-cols-12 gap-6 no-print">
            <div class="lg:col-span-8 glass p-6 rounded-2xl shadow-xl">
                <div class="flex justify-between items-center mb-6">
                    <div class="flex items-center gap-2 text-white font-bold text-[10px] uppercase tracking-widest"><i class="fa-solid fa-terminal text-slate-500"></i> SYSTEM.CONFIG</div>
                    <div id="gender-toggle" class="flex bg-git-bg p-1 rounded-lg border border-git-border">
                        <button onclick="setGender('Male')" id="btn-male" class="px-4 py-1.5 rounded-md text-[10px] font-bold bg-git-blue text-white shadow-lg transition-all">MALE</button>
                        <button onclick="setGender('Female')" id="btn-female" class="px-4 py-1.5 rounded-md text-[10px] font-bold text-slate-500 transition-all">FEMALE</button>
                    </div>
                </div>
                <div class="grid grid-cols-3 gap-4 mb-6">
                    <div class="space-y-1">
                        <span class="text-[9px] text-slate-500 font-bold uppercase ml-1">Birth Year</span>
                        <select id="birthYear" onchange="updateMatrix()" class="w-full bg-git-bg border border-git-border rounded-xl p-3 text-sm font-black text-white outline-none focus:border-git-blue"></select>
                    </div>
                    <div class="space-y-1">
                        <span class="text-[9px] text-slate-500 font-bold uppercase ml-1">Month</span>
                        <select id="birthMonth" onchange="updateMatrix()" class="w-full bg-git-bg border border-git-border rounded-xl p-3 text-sm font-black text-white outline-none focus:border-git-blue"></select>
                    </div>
                    <div class="space-y-1">
                        <span class="text-[9px] text-slate-500 font-bold uppercase ml-1">Day</span>
                        <select id="birthDay" onchange="updateMatrix()" class="w-full bg-git-bg border border-git-border rounded-xl p-3 text-sm font-black text-white outline-none focus:border-git-blue"></select>
                    </div>
                </div>
                <div class="pt-4 border-t border-git-border">
                    <span class="text-[9px] text-git-green font-bold uppercase tracking-widest mb-4 block px-1">Target Cycle Commitment</span>
                    <div id="year-selector" class="flex gap-2 overflow-x-auto no-scrollbar py-1"></div>
                </div>
            </div>
            <div class="lg:col-span-4 glass p-6 rounded-2xl flex flex-col justify-center items-center text-center">
                <span class="text-[10px] font-bold text-slate-500 uppercase mb-2 tracking-widest">Flow Intensity</span>
                <div id="flow-number" class="text-8xl font-black text-git-green tracking-tighter mb-2">--</div>
                <div id="flow-label" class="text-[9px] font-mono text-git-green uppercase px-3 py-1 bg-git-green/10 rounded-full border border-git-green/20">Init...</div>
            </div>
        </section>

        <!-- 2. ÂÖ®ÊÅØÊä•Âëä‰∏ª‰Ωì -->
        <main id="report-content" class="grid grid-cols-1 lg:grid-cols-12 gap-6 items-stretch">
            
            <!-- Â∑¶‰æßÈù¢Êùø -->
            <div class="lg:col-span-4 flex flex-col gap-6">
                <!-- Ë∫´‰ªΩÊëòË¶Å -->
                <div class="glass p-8 rounded-[2rem] shadow-2xl print:bg-white print:text-black">
                    <div class="flex items-center gap-4 mb-8 pb-8 border-b border-git-border print:border-slate-200">
                        <div id="avatar-box" class="w-16 h-16 rounded-2xl bg-git-bg flex items-center justify-center border border-git-border print:bg-slate-50 text-2xl">
                            <i class="fa-solid fa-mars text-git-blue"></i>
                        </div>
                        <div class="flex-1">
                            <h2 id="display-name" class="text-2xl font-black tracking-tight print:text-black">ÈòøÁõõ (Castor)</h2>
                            <p id="display-id" class="text-[9px] text-slate-500 font-mono uppercase mt-2 tracking-widest leading-none"></p>
                        </div>
                    </div>
                    <div id="metrics-list" class="space-y-5">
                        <!-- Metrics will be injected here -->
                    </div>
                    
                    <!-- Money Factor -->
                    <div class="mt-10 p-5 bg-git-bg rounded-xl border border-rose-500/20 print:bg-slate-50">
                        <div class="flex justify-between items-center mb-3">
                            <span class="text-[10px] font-black text-rose-400 uppercase flex items-center gap-2"><i class="fa-solid fa-cat"></i> Biological Buffer: Money</span>
                            <span class="text-[9px] font-mono text-rose-300">STABLE</span>
                        </div>
                        <div class="flex gap-1">
                            <div class="h-4 flex-1 bg-rose-500/30 rounded-sm"></div>
                            <div class="h-4 flex-1 bg-rose-500/30 rounded-sm"></div>
                            <div class="h-4 flex-1 bg-rose-500/30 rounded-sm"></div>
                            <div class="h-4 flex-1 bg-rose-500/30 rounded-sm"></div>
                            <div class="h-4 flex-1 bg-git-bg rounded-sm border border-git-border"></div>
                        </div>
                        <p class="text-[9px] text-slate-500 mt-3 italic text-center uppercase tracking-tighter">"Anchor Frequency for High-Freq Trading"</p>
                    </div>
                </div>

                <!-- ÊñπÁ®ãÂºè‰ª£Á†ÅÂùó -->
                <div class="glass p-6 rounded-2xl print:bg-slate-50">
                    <div class="flex items-center gap-2 mb-4">
                        <i class="fa-solid fa-code text-git-blue"></i>
                        <span class="text-[10px] font-black text-git-blue uppercase tracking-widest">matrix_kernel.json</span>
                    </div>
                    <pre id="code-logic" class="text-[11px] font-mono leading-[1.8] text-[#c9d1d9] bg-git-bg p-5 rounded-xl border border-git-border overflow-x-auto print:text-black print:bg-white"></pre>
                </div>
            </div>

            <!-- Âè≥‰æßÂ§ßÈù¢ÊùøÔºöÂÖ´ËßíÈõ∑Ëææ‰∏éÁÉ≠ÂäõÂõæ -->
            <div class="lg:col-span-8 glass p-10 rounded-[3rem] flex flex-col items-center justify-center relative print:bg-white print:border-slate-300">
                <div class="absolute top-10 left-12 flex items-center gap-2 opacity-20 no-print">
                    <i class="fa-solid fa-compass animate-spin-slow"></i>
                    <span class="text-[10px] font-mono tracking-[0.6em]">HOLOGRAPHIC_DECISION_ENGINE</span>
                </div>

                <!-- ÂÖ´ËßíÊï∞ÊçÆÁΩóÁõòÂÆπÂô® -->
                <div class="relative w-[500px] h-[500px] flex items-center justify-center">
                    <canvas id="radarChart"></canvas>
                    <!-- ‰∏≠ÂøÉ APEX Ë£ÖÈ•∞ -->
                    <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                        <div class="w-32 h-32 rounded-[2.5rem] bg-slate-900 border-4 border-git-border shadow-2xl flex flex-col items-center justify-center print:bg-white print:text-black">
                            <span class="text-[10px] font-mono text-slate-500 mb-1">MAIN_NODE</span>
                            <span id="center-f" class="text-7xl font-black leading-none">3</span>
                            <div class="h-0.5 w-12 bg-git-green my-2"></div>
                            <span class="text-[9px] font-bold text-git-blue tracking-widest uppercase">Exec.Init()</span>
                        </div>
                    </div>
                </div>

                <!-- GitHub Heatmap -->
                <div class="mt-16 w-full pt-10 border-t border-git-border print:border-slate-200">
                    <div class="flex justify-between items-end mb-4 px-4">
                        <h4 class="text-[11px] font-black text-white uppercase tracking-widest flex items-center gap-2 print:text-black"><i class="fa-solid fa-layer-group text-git-green"></i> Strategic Commitment Heatmap</h4>
                        <div class="flex gap-1 items-center no-print text-[8px] font-mono">
                            <span>Less</span>
                            <div class="w-3 h-3 rounded-sm bg-[#161b22]"></div>
                            <div class="w-3 h-3 rounded-sm bg-[#0e4429]"></div>
                            <div class="w-3 h-3 rounded-sm bg-[#006d32]"></div>
                            <div class="w-3 h-3 rounded-sm bg-[#26a641]"></div>
                            <div class="w-3 h-3 rounded-sm bg-[#39d353]"></div>
                            <span>More</span>
                        </div>
                    </div>
                    <div id="heatmap-grid" class="grid grid-cols-[repeat(52,1fr)] gap-1 overflow-hidden px-4">
                        <!-- Heatmap generated by JS -->
                    </div>
                </div>
            </div>
        </main>

        <!-- AI ÊàòÁï•Êä•ÂëäÂå∫Âüü -->
        <section class="flex flex-col gap-6 no-print">
            <div class="flex justify-between items-center px-4">
                <h3 class="text-[11px] font-bold text-slate-500 uppercase tracking-[0.5em] flex items-center gap-2"><i class="fa-solid fa-wand-magic-sparkles text-purple-400"></i> Bo AI Strategic Auditor</h3>
                <button onclick="generateAIReport()" id="ai-btn" class="px-10 py-3.5 bg-git-green hover:bg-[#2ea44f] text-white rounded-xl text-[11px] font-black uppercase tracking-widest flex items-center gap-3 shadow-2xl transition-all active:scale-95">
                    <i class="fa-solid fa-terminal"></i> COMPILE_STRATEGY
                </button>
            </div>
            <div id="ai-output" class="hidden glass p-12 rounded-[3rem] shadow-2xl relative overflow-hidden">
                <div class="flex items-center gap-3 mb-10 text-git-blue pb-6 border-b border-git-border">
                    <i class="fa-solid fa-file-code text-2xl"></i>
                    <div>
                        <h3 class="text-xl font-black uppercase tracking-widest">master-strategic-log.md</h3>
                        <p class="text-[10px] text-slate-500 font-mono tracking-[0.2em]">Compiler: Gemini-2.5-Bo | Version 5.0</p>
                    </div>
                </div>
                <div id="ai-text" class="text-[16px] leading-[2.1] border-l-4 border-git-border pl-10 italic whitespace-pre-wrap font-serif">
                    <!-- AI content -->
                </div>
            </div>
        </section>

        <!-- Command Terminal -->
        <section class="glass p-10 rounded-[3rem] shadow-2xl no-print relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-git-blue via-git-green to-git-red opacity-50"></div>
            <div class="flex gap-4">
                <span class="text-git-blue font-black text-xl mt-4">$</span>
                <input type="text" id="chat-input" placeholder="ËæìÂÖ•Êü•ËØ¢Êåá‰ª§, Â¶Ç: git analyse --risk --year 2026..." class="flex-grow bg-transparent border-none py-4 text-lg font-mono text-white focus:ring-0 outline-none">
                <button onclick="handleTerminalChat()" class="px-12 bg-[#21262d] hover:bg-[#30363d] border border-git-border text-white rounded-2xl font-black text-xs uppercase tracking-widest transition-all">RUN</button>
            </div>
        </section>

        <footer class="text-center pb-16 opacity-30 print:opacity-100 print:text-slate-400 print:mt-20">
            <p class="text-[11px] uppercase tracking-[1em] font-mono">BO MATRIX TERMINAL ‚Ä¢ PRECISION STRATEGY ‚Ä¢ CASTOR 2026 EDITION</p>
        </footer>
    </div>

    <script>
        // --- DATA STORE ---
        let currentProfile = {
            name: 'Castor ÈòøÁõõ',
            gender: 'Male',
            birthYear: 1980,
            birthMonth: 9,
            birthDay: 30,
            targetYear: 2026
        };

        const apiKey = ""; // API key ÁïôÁ©∫ÔºåÁéØÂ¢É‰ºöËá™Âä®Ê≥®ÂÖ•

        // --- UI INITIALIZATION ---
        window.onload = () => {
            initSelectors();
            updateMatrix();
            generateHeatmap();
        };

        function initSelectors() {
            const ySelect = document.getElementById('birthYear');
            const mSelect = document.getElementById('birthMonth');
            const dSelect = document.getElementById('birthDay');
            const flowSelect = document.getElementById('year-selector');

            for (let i = 1950; i <= 2026; i++) {
                let opt = new Option(i, i);
                if (i === 1980) opt.selected = true;
                ySelect.add(opt);
            }
            for (let i = 1; i <= 12; i++) {
                let opt = new Option(i, i);
                if (i === 9) opt.selected = true;
                mSelect.add(opt);
            }
            for (let i = 1; i <= 31; i++) {
                let opt = new Option(i, i);
                if (i === 30) opt.selected = true;
                dSelect.add(opt);
            }

            [2024, 2025, 2026, 2027, 2028, 2029, 2030].forEach(y => {
                let btn = document.createElement('button');
                btn.className = `shrink-0 px-5 py-2.5 rounded-xl text-xs font-black transition-all border ${y === 2026 ? 'bg-[#388bfd]/20 border-git-blue text-git-blue' : 'bg-[#0d1117] border-git-border text-slate-500'}`;
                btn.innerText = y;
                btn.onclick = () => setTargetYear(y, btn);
                flowSelect.appendChild(btn);
            });
        }

        // --- CORE NUMEROLOGY LOGIC ---
        function reduceNum(n) {
            if (!n) return 0;
            let num = Math.abs(parseInt(n));
            while (num > 9) {
                num = String(num).split('').reduce((acc, curr) => acc + parseInt(curr), 0);
            }
            return num;
        }

        function calculateResults() {
            const y = parseInt(document.getElementById('birthYear').value);
            const m = parseInt(document.getElementById('birthMonth').value);
            const d = parseInt(document.getElementById('birthDay').value);
            const ty = currentProfile.targetYear;

            const dStr = String(d).padStart(2, '0');
            const mStr = String(m).padStart(2, '0');
            const yStr = String(y);

            const A = reduceNum(parseInt(dStr[0]) + parseInt(dStr[1]));
            const B = reduceNum(parseInt(mStr[0]) + parseInt(mStr[1]));
            const C = reduceNum(reduceNum(parseInt(yStr[0]) + parseInt(yStr[1])) + reduceNum(parseInt(yStr[2]) + parseInt(yStr[3])));

            const D = reduceNum(A + B);
            const E = reduceNum(B + C);
            const F = reduceNum(D + E);

            const G = reduceNum(A + D);
            const H = reduceNum(C + E);
            const I = reduceNum(D + F);
            const J = reduceNum(E + F);
            const K = reduceNum(I + J);

            const py = reduceNum(ty + reduceNum(m) + reduceNum(d));

            return { A, B, C, D, E, F, G, H, I, J, K, py };
        }

        let chartInstance = null;

        function updateMatrix() {
            const res = calculateResults();
            
            // Update Flow Info
            document.getElementById('flow-number').innerText = res.py;
            document.getElementById('flow-label').innerText = res.py === 4 ? "Architectural Sync" : "Flow Shifting";
            document.getElementById('center-f').innerText = res.F;
            document.getElementById('display-id').innerText = `ID: ${document.getElementById('birthYear').value}${document.getElementById('birthMonth').value}${document.getElementById('birthDay').value} | BRANCH: MAIN`;

            // Update Logic Panel
            document.getElementById('code-logic').innerText = 
`const LifeMatrix = {
  apex_node: ${res.F}, // ‰∏ªÂëΩÊï∞
  base_sitting: ${res.K}, // ÂùêÈïá
  flow_cycle: ${res.py}, // ÊµÅÂπ¥
  status: "${res.py === 4 ? 'STABLE_BUILD' : 'REFACTORING'}",
  version: "5.0.0-stable"
};`;

            // Data for Radar
            const metrics = [
                { label: 'ÊâßË°åÈÄüÂ∫¶', val: res.A * 11 },
                { label: 'ÊàòÁï•ÈÄªËæë', val: res.D * 11 },
                { label: 'Ê†∏ÂøÉËÉΩÈáè', val: res.F * 11 },
                { label: 'ÁéØÂ¢ÉÈÄÇÂ∫î', val: res.C * 11 },
                { label: 'ÊÑüÂÆòÁõ¥Ëßâ', val: res.B * 11 },
                { label: 'È£éÈô©ÊéßÂà∂', val: res.py === 4 ? 98 : 50 },
                { label: 'Êú™Êù•Â¢ûÁõä', val: res.H * 11 },
                { label: 'ÂùêÈïáÂ∫ïËï¥', val: res.K * 11 }
            ];

            // Render Metrics List (Left Panel)
            const listContainer = document.getElementById('metrics-list');
            listContainer.innerHTML = metrics.map(m => `
                <div class="space-y-1.5">
                    <div class="flex justify-between items-center text-[10px] font-bold uppercase">
                        <span class="text-slate-500">${m.label}</span>
                        <span class="text-white">${m.val}%</span>
                    </div>
                    <div class="h-1 w-full bg-git-bg rounded-full overflow-hidden border border-git-border">
                        <div class="h-full bg-git-blue transition-all duration-1000" style="width: ${m.val}%"></div>
                    </div>
                </div>
            `).join('');

            // Render Radar Chart
            if(chartInstance) chartInstance.destroy();
            const ctx = document.getElementById('radarChart').getContext('2d');
            chartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: metrics.map(m => m.label),
                    datasets: [{
                        data: metrics.map(m => m.val),
                        backgroundColor: 'rgba(56, 139, 253, 0.1)',
                        borderColor: '#58a6ff',
                        borderWidth: 2,
                        pointBackgroundColor: '#58a6ff',
                        pointRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            grid: { color: '#30363d' },
                            angleLines: { color: '#30363d' },
                            pointLabels: { color: '#8b949e', font: { size: 10, weight: 'bold' } },
                            ticks: { display: false },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        // --- INTERACTIVE HANDLERS ---
        function setGender(g) {
            currentProfile.gender = g;
            document.getElementById('btn-male').className = g === 'Male' ? 'px-4 py-1.5 rounded-md text-[10px] font-bold bg-git-blue text-white shadow-lg transition-all' : 'px-4 py-1.5 rounded-md text-[10px] font-bold text-slate-500 transition-all';
            document.getElementById('btn-female').className = g === 'Female' ? 'px-4 py-1.5 rounded-md text-[10px] font-bold bg-git-red text-white shadow-lg transition-all' : 'px-4 py-1.5 rounded-md text-[10px] font-bold text-slate-500 transition-all';
            document.getElementById('avatar-box').innerHTML = g === 'Male' ? '<i class="fa-solid fa-mars text-git-blue"></i>' : '<i class="fa-solid fa-venus text-git-red"></i>';
            updateMatrix();
        }

        function setTargetYear(y, el) {
            currentProfile.targetYear = y;
            document.querySelectorAll('#year-selector button').forEach(btn => {
                btn.className = 'shrink-0 px-5 py-2.5 rounded-xl text-xs font-black transition-all border bg-[#0d1117] border-git-border text-slate-500';
            });
            el.className = 'shrink-0 px-5 py-2.5 rounded-xl text-xs font-black transition-all border bg-[#388bfd]/20 border-git-blue text-git-blue shadow-lg';
            updateMatrix();
        }

        function generateHeatmap() {
            const grid = document.getElementById('heatmap-grid');
            grid.innerHTML = '';
            for (let i = 0; i < 52 * 7; i++) {
                let cell = document.createElement('div');
                let seed = Math.random();
                let color = seed > 0.9 ? 'bg-[#39d353]' : seed > 0.7 ? 'bg-[#26a641]' : seed > 0.4 ? 'bg-[#006d32]' : seed > 0.2 ? 'bg-[#0e4429]' : 'bg-[#161b22]';
                cell.className = `heatmap-cell ${color}`;
                grid.appendChild(cell);
            }
        }

        // --- AI API LOGIC ---
        async function callBo(prompt, system) {
            const output = document.getElementById('ai-output');
            const text = document.getElementById('ai-text');
            const btn = document.getElementById('ai-btn');

            output.classList.remove('hidden');
            text.innerHTML = ">>> COMPILING STRATEGIC LOGS...\n>>> ACCESSING DECISION KERNEL...";
            btn.disabled = true;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const body = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: system }] }
            };

            try {
                const response = await fetch(url, { method: 'POST', body: JSON.stringify(body), headers: { 'Content-Type': 'application/json' } });
                const data = await response.json();
                const result = data.candidates?.[0]?.content?.parts?.[0]?.text || "COMPILE_FAILED: UNKNOWN_ERROR";
                text.innerText = result;
            } catch (err) {
                text.innerText = "CRITICAL_ERROR: " + err.message;
            } finally {
                btn.disabled = false;
            }
        }

        function generateAIReport() {
            const res = calculateResults();
            const prompt = `Analyze 1980-09-30, Year ${currentProfile.targetYear} (Flow ${res.py}). Focus: Coach & Trader. Áã∏Ëä±Áå´ Money ‰∏∫ÊÉÖÁª™‰∏≠ÂíåÈ°π„ÄÇËØ∑ÁªôÂá∫Êï¥ÈΩê„ÄÅ‰∏ì‰∏ö„ÄÅ‰ª£Á†ÅÂÆ°ËÆ°È£éÊ†ºÁöÑ‰∏≠ÊñáÂª∫ËÆÆ„ÄÇ`;
            callBo(prompt, "You are a professional strategist Bo.");
        }

        function handleTerminalChat() {
            const input = document.getElementById('chat-input').value;
            if(!input.trim()) return;
            callBo(input, "Respond as Bo, the strategic assistant.");
            document.getElementById('chat-input').value = '';
        }

        function shareWhatsApp() {
            const res = calculateResults();
            const msg = encodeURIComponent(
                `üìä CASTOR STRATEGIC BLUEPRINT v5.0\n` +
                `üî¢ APEX: ${res.F} | FLOW: ${res.py} | ÂùêÈïá: ${res.K}\n` +
                `üí° 2026Âπ¥Á≠ñÁï•ÔºöÊû∂ÊûÑÊâéÊ†πÔºåÈò≤ÂÆàÊÄßÂ¢ûÈïø„ÄÇ\n` +
                `>>> ÂÖ®ÊÅØÈáèÂåñÊä•ÂëäÂ∑≤ÁîüÊàê„ÄÇ`
            );
            window.open(`https://wa.me/?text=${msg}`, '_blank');
        }
    </script>
</body>
</html>
